# Описание проекта и задачи (RU)

## Проект: прогноз оттока клиентов телеком‑оператора «ТелеДом»

**Цель:** обучить модель, которая заранее предсказывает, разорвёт ли абонент договор, чтобы вовремя запустить удержание (промокоды, спецусловия).  
**Контекст:** компания собрала персональные данные клиентов, сведения о тарифах и подключённых услугах. Информация о договорах актуальна на **2020‑02‑01**.

---

## Описание услуг

Оператор предоставляет два базовых направления услуг:
- **Телефония:** стационарная связь, возможны **несколько линий** одновременно.
- **Интернет:** подключения **DSL** (через телефонную линию) и **Fiber optic** (оптоволокно).

Дополнительные сервисы:
- **Интернет‑безопасность:** `DeviceProtection` (антивирус), `OnlineSecurity` (блокировка опасных сайтов);
- **TechSupport:** выделенная линия техподдержки;
- **OnlineBackup:** облачное резервное копирование;
- **StreamingTV** и **StreamingMovies:** ТВ и каталог фильмов.

Оплата: **ежемесячно** или **контракт на 1–2 года**, разные способы оплаты, электронный чек (`PaperlessBilling`).

---

## Описание данных

Данные состоят из четырёх таблиц, объединяемых по `customerID`:

### 1) `contract_new.csv` — договор
- `customerID` — идентификатор абонента
- `BeginDate` — дата начала договора
- `EndDate` — дата окончания договора
- `Type` — тип договора (Month‑to‑month / One year / Two year)
- `PaperlessBilling` — электронный расчётный лист (Yes/No)
- `PaymentMethod` — способ оплаты
- `MonthlyCharges` — ежемесячные начисления
- `TotalCharges` — суммарные начисления за всё время

### 2) `personal_new.csv` — персональные данные
- `customerID`
- `gender` — пол
- `SeniorCitizen` — пенсионер (0/1)
- `Partner` — наличие супруга/супруги (Yes/No)
- `Dependents` — наличие иждивенцев (Yes/No)

### 3) `internet_new.csv` — интернет‑услуги
- `customerID`
- `InternetService` — тип подключения (DSL/Fiber/No)
- `OnlineSecurity` — блокировка опасных сайтов (Yes/No/No internet service)
- `OnlineBackup` — облачное резервное копирование (Yes/No/No internet service)
- `DeviceProtection` — антивирус (Yes/No/No internet service)
- `TechSupport` — выделенная техподдержка (Yes/No/No internet service)
- `StreamingTV` — стриминговое ТВ (Yes/No/No internet service)
- `StreamingMovies` — каталог фильмов (Yes/No/No internet service)

### 4) `phone_new.csv` — телефония
- `customerID`
- `MultipleLines` — несколько телефонных линий (Yes/No/No phone service)

> Все таблицы связываются по `customerID`. Срез актуален на **2020‑02‑01**. Данные также доступны в облаке в `/datasets/`.

---

## План работы

**Шаг 1. Загрузка данных**  
Импорт файлов, первичный осмотр, проверка типов и пропусков.

**Шаг 2. EDA и предобработка (по таблицам)**  
Исследование распределений, обработка пропусков с учётом бизнес‑смысла (например, *No internet/No phone service* вместо `NaN`). Промежуточные выводы: какие признаки полезны для моделирования.

**Шаг 3. Объединение**  
Сформировать единый датафрейм по `customerID` из отобранных признаков.

**Шаг 4. EDA объединённого датасета**  
Визуализации, корреляционный анализ (в т.ч. PHIK для категориальных), генерация новых признаков (например, `contract_duration`, агрегаты по услугам), проверка мультиколлинеарности.

**Шаг 5. Подготовка данных**  
Трейн/тест сплит, построение пайплайнов препроцессинга: кодирование категорий (OHE/Ordinal/нативное в CatBoost), масштабирование числовых, корректная импьютация (`TotalCharges=0` при `tenure=0`, иначе медиана).

**Шаг 6. Обучение моделей**  
Обучить минимум две модели (например, Logistic Regression, RandomForest, CatBoost). Для хотя бы одной — тюнинг ≥2 гиперпараметров (RandomizedSearchCV/GridSearchCV).

**Шаг 7. Выбор лучшей модели**  
Кросс‑валидация по метрике **AUC‑ROC** (целевая метрика), подбор **порога** на OOF‑предсказаниях, затем единичная финальная оценка на **test**.

**Шаг 8. Выводы и рекомендации**  
Качество лучшей модели, интерпретация факторов (Permutation Importance/SHAP), рекомендации по использованию прогноза для удержания (порог, сценарии кампаний, стоимость ошибок).

---

## Ожидаемый результат

- Репозиторий с воспроизводимым кодом и отчётом;
- Модель, достигающая требуемого качества по **AUC‑ROC ≥ 0.85** на тесте;
- Практические рекомендации для бизнеса (режим работы по порогу, приоритизация клиентских сегментов).
